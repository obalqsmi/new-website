!function(){const d={newsletterApp:{settings:window.themeVariables.settings}.settings.newsletterApp},c={section:".dbtfy-newsletter-popup"};"mailchimp"!==d.newsletterApp&&(document.body.classList.add("dbtfy-newsletter-popup-enabled"),"/challenge"!==window.location.pathname)&&theme.helpers.loadComponents(["discountCode","modal"],()=>{if(n=document.querySelector(c.section)){var e=theme.helpers.safelyParseJson(n.dataset.sectionSettings);if(e){d.enableTimeTrigger=e.enableTimeTrigger,d.timeTriggerTimeout=e.timeTriggerTimeout,d.enableExitIntentTrigger=e.enableExitIntentTrigger,d.enableScrollDepthTrigger=e.enableScrollDepthTrigger,d.scrollDepthPercentage=e.scrollDepthPercentage,d.discountName=e.discountName,d.discountAmount=e.discountAmount,d.discountType=e.discountType;const i=n.querySelector(".dbtfy-newsletter-popup__modal");var e=n.querySelector(".dbtfy-newsletter-popup__input"),t=n.querySelector(".dbtfy-newsletter-popup__form-success"),o=n.querySelector(".dbtfy-newsletter-popup__reward"),n=n.querySelector(".dbtfy-newsletter-popup__floating-bar");if(768<window.innerWidth?e?.removeAttribute("data-focus"):e?.setAttribute("data-focus","true"),i&&i.addEventListener("modal.close",()=>{sessionStorage.setItem("newsletterPopupClosed","true"),s()}),window.addEventListener("blur",()=>{Array.from(document.querySelectorAll("iframe")).some(e=>document.activeElement===e)&&r()}),n?.addEventListener("click",()=>{sessionStorage.removeItem("newsletterPopupClosed"),r()}),t)r(),o?.addEventListener("click",()=>{var e=d.discountName,t=d.discountType,o=d.discountAmount;e&&t&&o&&(theme.discountCode.addDiscount(e,t,o),theme.discountCode.init())});else if(!sessionStorage.newsletterPopupClosed&&(d.enableTimeTrigger&&setTimeout(function(){r()},d.timeTriggerTimeout),d.enableExitIntentTrigger&&document.body.addEventListener("mouseleave",e=>{e.clientY<0&&r()}),d.enableScrollDepthTrigger)){e=document.body,n=document.documentElement,t=Math.max(e.scrollHeight,e.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight);const l=Math.floor(t/100*d.scrollDepthPercentage);window.addEventListener("scroll",()=>{window.scrollY>l&&r()})}function r(){sessionStorage.newsletterPopupClosed||(s(),theme.Modal.open(i))}function s(){document.querySelectorAll(".modal.js-modal-open").forEach(e=>{"newsletter-popup"!==e.id&&e.classList.toggle("not-priority")})}}}})}();