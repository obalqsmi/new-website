!function(){var e={addon:window.themeVariables.settings.addons.deliveryDate,addonStrings:window.themeVariables.strings.addons.deliveryDate};const f={requiredToCheckout:e.addon.requiredToCheckout,excludeDays:e.addon.excludeDays,warningMessage:e.addonStrings.warning},p={section:".dbtfy-delivery-date",clearButton:".dbtfy-delivery-date__clear-button",dateField:".dbtfy-delivery-date__input",warningMessage:".dbtfy-delivery-date__error-message",checkoutButton:"[name='checkout'], [name='goto_pp'], [name='goto_gc']"};function t(e){var t=[{name:"flatPickr",type:"css",src:window.themeVariables.files.vendors.css.flatPickr},{name:"flatPickr",type:"js",src:window.themeVariables.files.vendors.js.flatPickr}];theme.helpers.loadAssets(t,()=>{f.requiredToCheckout?theme.helpers.loadComponent("requiredToCheckout",()=>{r(e)}):r(e)})}function r(e){function y(e){let t=!0;return t=f.requiredToCheckout&&!e.value?!1:t}function v(e,t){e.length&&(t?e.forEach(e=>{e.innerHTML=f.warningMessage,e.removeAttribute("hidden")}):e.forEach(e=>{e.setAttribute("hidden","hidden")}))}f.requiredToCheckout&&theme.requiredToCheckoutAddons.init("delivery-date"),e&&0===e.item_count&&localStorage.removeItem("deliveryDate"),document.querySelectorAll(p.section).forEach(e=>{var t,r=e.querySelector(p.clearButton);const a=document.querySelectorAll(p.clearButton),d=e.querySelector(p.dateField),n=document.querySelectorAll(p.dateField),i=document.querySelectorAll(p.warningMessage),s={0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"},c=[];if(r&&r.addEventListener("click",e=>{n.forEach(e=>{e.value=""}),localStorage.removeItem("deliveryDate"),f.requiredToCheckout&&theme.requiredToCheckoutAddons.update({name:"delivery-date",errors:!0,isChanged:!0}),a.forEach(e=>{e.setAttribute("hidden","hidden")})}),d){var l=f.excludeDays&&f.excludeDays.split(",").filter(e=>e).map(e=>e.trim().toLowerCase());for(const u in s)l&&l.forEach(e=>{s[u].toLowerCase().includes(e)&&c.push(+u)});e=d,t=c,e.classList.contains("flatpickr-input")||flatpickr(e,{enableTime:!0,minDate:"today",disable:[function(e){return t.includes(e.getDay())}]});y(d);let o;d.addEventListener("change",e=>{var t,r,e=e.target.value;o=y(d),e?(localStorage.setItem("deliveryDate",e),v(i),f.requiredToCheckout&&theme.requiredToCheckoutAddons.update({name:"delivery-date",errors:!1,isChanged:!0}),a.forEach(e=>{e.removeAttribute("hidden")})):(localStorage.removeItem("deliveryDate"),f.requiredToCheckout&&theme.requiredToCheckoutAddons.update({name:"delivery-date",errors:!0,isChanged:!0}),o||v(i,!0)),t=n,r=e,t&&t.forEach(e=>{e.value=r})}),localStorage.deliveryDate?(n.forEach(e=>{e.value=localStorage.deliveryDate}),f.requiredToCheckout&&theme.requiredToCheckoutAddons.update({name:"delivery-date",errors:!1}),a.forEach(e=>{e.removeAttribute("hidden")})):f.requiredToCheckout&&theme.requiredToCheckoutAddons.update({name:"delivery-date",errors:!0})}}),document.querySelectorAll(p.checkoutButton).forEach(m=>{m.hasAttribute("data-delivery-date-event")||(m.addEventListener("click",t=>{var r=m.closest("form")?.querySelector(p.section);if(r){var o=r.querySelector(p.dateField),a=document.querySelectorAll(p.warningMessage);if(o)if(y(o))f.requiredToCheckout&&theme.requiredToCheckoutAddons.update({name:"delivery-date",errors:!1,isCheckoutButtonEventHandled:!0,button:{element:m,event:t}}),v(a),fetch("/cart/update.js",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({attributes:{"Delivery date":theme.helpers.attributeToString(o.value)}})});else{f.requiredToCheckout&&theme.requiredToCheckoutAddons.update({name:"delivery-date",errors:!0,isCheckoutButtonEventHandled:!0,button:{element:m,event:t}}),v(a,!0);{o=r,t=m;let e;"drawer"===window.themeVariables.settings.cartType?e="#CartDrawer":"modal"===window.themeVariables.settings.cartType&&(e="#CartModal");const d=t.closest(e),n=document.body.classList.contains("template-cart"),i=d?.querySelector(".drawer__header"),s=d?.querySelector(".drawer__inner"),c=d?.querySelector("form"),l=o.offsetTop||0,u=i?.innerHeight||0,h=c?.offsetTop||0;if(d&&(d.classList.contains("js-drawer-open")||d.classList.contains("js-modal-open")))s.scrollTo({top:l-u-h,behavior:"smooth"});else if(n){t=document.querySelector(".header"),o=document.querySelector(".cart__form")?.querySelector(p.section),a=document.body.classList.contains("sticky-header");const l=o?.offsetTop||0;o=a?t.innerHeight:0;window.scrollTo({top:l-o-15,behavior:"smooth"})}}}}}),m.setAttribute("data-delivery-date-event","true"))})}document.body.classList.add("dbtfy-delivery-date-enabled"),t(),document.addEventListener("shopify:section:load",()=>{t()}),document.addEventListener("theme:cart:loaded",e=>{t(e.detail.cart)})}();