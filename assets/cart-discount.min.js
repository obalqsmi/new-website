!function(){const c={addonSection:".dbtfy-cart-discount",input:".dbtfy-cart-discount__input",submitButton:".dbtfy-cart-discount__button"};function e(){document.querySelectorAll(c.addonSection).forEach(t=>{if(!t.hasAttribute("data-inited")){const n=t.querySelector(c.input);var e;n&&(n.addEventListener("keydown",t=>{13===t.keyCode&&(t.preventDefault(),""!==n.value)&&o(n.value)}),(e=t.querySelector(c.submitButton))&&e.addEventListener("click",t=>{t.preventDefault(),""!==n.value&&o(n.value)}),t.setAttribute("data-inited","true"))}})}function n(t){fetch("/discount/"+t,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}}).then(t=>{t.ok&&theme.ajaxCart.update()}).catch(t=>{})}function o(e){var t=document.querySelector(".cart-discount__discount");t&&""!==t.textContent.trim()?confirm("Are you sure you want to replace the current discount?")&&n(e):fetch("/cart.js").then(t=>t.json()).then(t=>{(!(t.cart_level_discount_applications&&0<t.cart_level_discount_applications.length)||confirm("Are you sure you want to replace the current discount?"))&&n(e)}).catch(t=>{n(e)})}document.body.classList.add("dbtfy-cart-discount-enabled"),e(),document.addEventListener("theme:cart:loaded",t=>{e()})}();