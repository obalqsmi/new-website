window.theme=window.theme||{},theme.ProductQuantities=function(){function s(t,e,a){var r;t&&e&&(a=a.selectedOptions[0])&&(r=theme.helpers.safelyParseJson(a.dataset.variantSettings),a=a.hasAttribute("data-remain-qty")?+a.dataset.remainQty:r.productQty,r=+e.value,t=t.querySelector(".product-quantity__button--plus"),0<a?a<=r?(t&&t.setAttribute("disabled","disabled"),e.value=a):t&&t.removeAttribute("disabled"):(e.value=1,t&&t.setAttribute("disabled","disabled")),0==r)&&0<a&&(e.value=1)===a&&t&&t.setAttribute("disabled","disabled")}async function o(t,e,r){var a,n;t&&e&&(a=r.querySelectorAll("option"),n=await theme.ShopifyAPI.getCart(),a.forEach(t=>{var e=theme.helpers.safelyParseJson(t.dataset.variantSettings).productQty;t.setAttribute("data-remain-qty",e)}),n&&n.items.forEach(t=>{var e,a=t.id,t=t.quantity,a=r.querySelector(`option[value='${a}']`);a&&(e=theme.helpers.safelyParseJson(a.dataset.variantSettings).productQty,a.setAttribute("data-remain-qty",e-t))}),s(t,e,r),document.dispatchEvent(new Event("updatedProductRemainingQuantities")))}return{setMaxQuantity:function(t,e,a){t&&e&&a&&(t=a.selectedOptions[0])&&(a=theme.helpers.safelyParseJson(t.dataset.variantSettings),0<(t=t.hasAttribute("data-remain-qty")?+t.dataset.remainQty:+a.productQty)?e&&e.setAttribute("max",t):e&&e.removeAttribute("max"))},checkQuantity:s,setVariantQuantities:o,syncQuantityInputs:function(t){var e=document.querySelector(".template-product"),a=document.querySelector(".product.section");e&&a&&t&&(t.closest(".featured-product")||(a=a.querySelector(".product-quantity__input"),e=e.querySelector(".dbtfy-sticky-addtocart__quantity input"),a&&e&&(t=+t.value,a.value=t,e&&(e.value=t),document.dispatchEvent(new Event("theme:section:product:quantity-sync")))))},refreshInventoryData:async function(t,e,a){if(t&&e&&a){var r=t.closest(".product.section");if(r&&r.dataset.productId){r=r.dataset.productId;try{var n=await fetch(`/products/${r}.js`);if(!n.ok)throw new Error("HTTP error! status: "+n.status);const i=await n.json();a.querySelectorAll("option").forEach(t=>{if(t.value){const r=parseInt(t.value);var e,a=i.variants.find(t=>t.id===r);a&&t.dataset.variantSettings&&(e=theme.helpers.safelyParseJson(t.dataset.variantSettings))&&(e.inventoryQuantity=a.inventory_quantity,e.productQty=a.inventory_quantity,t.dataset.variantSettings=JSON.stringify(e))}}),await o(t,e,a),s(t,e,a)}catch(t){console.error("Error refreshing inventory:",t)}}}}}}();