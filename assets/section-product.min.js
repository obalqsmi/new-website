window.theme=window.theme||{},theme.Product=function(){function t(t){this.container=t,this.selectors={productGallery:"[data-product-gallery]",productMediaGroup:"[data-product-media-group]",productMediaWrapper:"[data-product-media-wrapper]",productMediaFlexWrapper:"[data-product-media-flex-wrapper]",productMediaTypeModel:"[data-product-media-type-model]",productMediaTypeVideo:"[data-product-media-type-video]",productThumbnails:"[data-product-thumbnails]",productThumbnail:"[data-product-thumbnail]",productOption:"[data-product-option]",productOptionLabel:"[data-product-option-label]",singleOptionSelector:"[data-product-option-selector]",masterSelect:"[data-product-master-select]",productJSON:"[data-product-json]",productMeta:"[data-product-meta]",productPriceContainer:"[data-product-price-container]",productPrice:"[data-product-price]",productPriceCompare:"[data-product-price-compare]",addToCart:"[data-product-add-to-cart]",addToCartText:"[data-product-add-to-cart-text]",productFullDetails:"[data-product-full-details]",unitPrice:"[data-unit-price]",unitPriceBaseUnit:"[data-unit-price-base-unit]",sku:"[data-product-sku]",productQuantity:"[data-product-quantity]",productQuantityInput:"[data-product-quantity-input]",productQuantityButton:"[data-product-quantity-button]"},this.classes={priceContainerUnitAvailable:"product-price-container--unit-available",featuredMedia:"featured-media",hidden:"hidden",soldOut:"product__meta--sold-out"},this.sectionSettings=theme.helpers.safelyParseJson(this.container.dataset.sectionSettings),this.productGallery=this.container.querySelector(this.selectors.productGallery),this.productMedias=this.container.querySelectorAll(this.selectors.productMediaWrapper),this.productMeta=this.container.querySelector(this.selectors.productMeta),this.masterSelect=this.container.querySelector(this.selectors.masterSelect),this.productPriceContainer=this.container.querySelector(this.selectors.productPriceContainer),this.productPrice=this.container.querySelector(this.selectors.productPrice),this.productPriceCompare=this.container.querySelector(this.selectors.productPriceCompare),this.productOptionLabels=this.container.querySelectorAll(this.selectors.productOptionLabel),this.singleOptionSelectors=this.container.querySelectorAll(this.selectors.singleOptionSelector),this.productQuantity=this.container.querySelector(this.selectors.productQuantity),this.productQuantityInput=this.container.querySelector(this.selectors.productQuantityInput),this.sku=this.container.querySelector(this.selectors.sku),this.unitPrice=this.container.querySelector(this.selectors.unitPrice),this.unitPriceBaseUnit=this.container.querySelector(this.selectors.unitPriceBaseUnit),this.addToCart=this.container.querySelector(this.selectors.addToCart),this.addToCartText=this.container.querySelector(this.selectors.addToCartText),this.productFullDetails=this.container.querySelector(this.selectors.productFullDetails),this.productJSONScript=this.container.querySelector(this.selectors.productJSON),this.productJSON=this.productJSONScript?theme.helpers.safelyParseJson(this.productJSONScript.innerHTML):null,this.productJSON&&(1<this.productMedias.length?(t={name:"enquire",type:"js",src:window.themeVariables.files.vendors.js.enquire},theme.helpers.loadAsset(t).then(()=>{theme.helpers.loadComponent("slider",()=>{this.initThumbnails(),this.initGallery()}),theme.helpers.loadComponent("variants",()=>{this.initProductVariants()}),this.initModelViewerLibraries(),this.initShopifyXrLaunch(),theme.helpers.loadComponent("productQuantities",()=>{this.initProductQuantities()})})):(theme.helpers.loadComponent("slider",()=>{this.initThumbnails(),this.initGallery()}),theme.helpers.loadComponent("variants",()=>{this.initProductVariants()}),this.initModelViewerLibraries(),this.initShopifyXrLaunch(),theme.helpers.loadComponent("productQuantities",()=>{this.initProductQuantities()})))}return t.prototype=Object.assign({},t.prototype,{lazyLoadImages:function(t){t&&(t.querySelectorAll("img[data-src]").forEach(t=>{var e=t.dataset.src,i=t.dataset.srcset;t.setAttribute("src",e),i&&t.setAttribute("srcset",i),t.removeAttribute("data-src"),t.removeAttribute("data-srcset")}),theme.helpers.loadComponent("imagesLazyloading",()=>{theme.imagesLazyLoading()}))},initThumbnails:function(){const t=this;if(this.slider=this.container.querySelector(this.selectors.productMediaGroup),this.thumbnails=this.container.querySelectorAll(this.selectors.productThumbnail),this.thumbnailsWrapper=this.container.querySelector(this.selectors.productThumbnails),this.slider&&this.thumbnailsWrapper&&!(this.thumbnails.length<2)){var e=this.sectionSettings.isStackedLayout;const i={slidesToShow:5,slidesToScroll:1,focusOnSelect:!0,infinite:!1,swipeToSlide:!0,arrows:!0,dots:!1,asNavFor:this.slider,speed:window.themeVariables.animation.speed};e?(enquire.register(window.themeVariables.breakpoints.lg,{match:function(){theme.Slider.destroy(t.thumbnailsWrapper),t.lazyLoadImages.bind(t)(t.thumbnailsWrapper)}}),enquire.register(window.themeVariables.breakpoints["lg-max"],{match:function(){theme.Slider.init({slider:t.thumbnailsWrapper,options:i,events:{init:()=>{t.lazyLoadImages.bind(t)(t.thumbnailsWrapper)}}})}})):theme.Slider.init({slider:t.thumbnailsWrapper,options:i,events:{init:()=>{t.lazyLoadImages.bind(t)(t.thumbnailsWrapper)}}})}},initGallery:function(){const t=this;if(this.slider=this.container.querySelector(this.selectors.productMediaGroup),this.sliderItems=this.container.querySelector(this.selectors.productMediaFlexWrapper),this.thumbnailsWrapper=this.container.querySelector(this.selectors.productThumbnails),!this.slider||!this.thumbnailsWrapper||this.sliderItems<2)this.lazyLoadImages(this.slider);else{var e=this.sectionSettings.enableFadingEffect,i=this.sectionSettings.isStackedLayout;const s={slidesToShow:1,slidesToScroll:1,focusOnSelect:!1,infinite:!1,adaptiveHeight:!0,arrows:!0,dots:!1,fade:e,asNavFor:this.thumbnailsWrapper,speed:window.themeVariables.animation.speed};i?(enquire.register(window.themeVariables.breakpoints.lg,{match:function(){theme.Slider.destroy(t.slider),t.initGalleryVideos.bind(t)(),t.lazyLoadImages.bind(t)(t.slider)}}),enquire.register(window.themeVariables.breakpoints["lg-max"],{match:function(){theme.Slider.init({slider:t.slider,options:s,events:{afterChange:t.setFeaturedMedia.bind(t),init:()=>{t.lazyLoadImages.bind(t)(t.slider),t.initGalleryVideos.bind(t)()}}})}})):theme.Slider.init({slider:t.slider,options:s,events:{afterChange:t.setFeaturedMedia.bind(t),init:()=>{t.lazyLoadImages.bind(t)(t.slider),t.initGalleryVideos.bind(t)()}}})}},initGalleryVideos:function(){var t,e;this.productGallery&&(t=this.productGallery.querySelector("lite-youtube"),e=this.productGallery.querySelector("lite-vimeo"),(t||e)&&(t&&theme.helpers.initYoutubeLite(()=>{this.initGalleryVideosListeners("youtube")}),e&&theme.helpers.initVimeoLite(this.productGallery,()=>{this.initGalleryVideosListeners("vimeo")}),theme.helpers.lazyLoadPosters(this.productGallery)),this.initGalleryVideosListeners())},initGalleryVideosListeners:function(r){function t(t){var e=t.querySelector("lite-youtube, lite-vimeo, video");let i,s;if(e)switch(e.tagName){case"LITE-YOUTUBE":"vimeo"!==r&&(i=e.querySelector(".lty-playbtn"),s=e.querySelector("iframe"),i&&!s&&i.click(),s)&&s.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*");break;case"LITE-VIMEO":"youtube"!==r&&(i=e.querySelector(".ltv-playbtn"),s=e.querySelector("iframe"),i&&!s&&i.click(),s)&&s.contentWindow.postMessage('{"method":"play","value":"true"}',"*");break;case"VIDEO":document.body.classList.contains("dbtfy-product-zooming-full-screen-enabled")||e.play()}}this.container.querySelectorAll(this.selectors.productMediaTypeVideo).forEach(s=>{s.classList.contains(this.classes.featuredMedia)&&t(s),s.addEventListener("mediaVisible",()=>{t(s)}),s.addEventListener("mediaHidden",()=>{{var e,i=s.querySelector("lite-youtube, lite-vimeo, video");let t;if(i)switch(i.tagName){case"LITE-YOUTUBE":(t=i.querySelector("iframe"))&&t.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*");break;case"LITE-VIMEO":(t=i.querySelector("iframe"))&&t.contentWindow.postMessage('{"method":"pause","value":"true"}',"*");break;case"VIDEO":i.pause()}}})}),theme.helpers.handleVideos()},setFeaturedMedia:function(){var t=this.container.querySelector(this.selectors.productMediaGroup+" .slick-slide.slick-active "+this.selectors.productMediaWrapper).dataset.mediaId;this.triggerMediaChangeEvent(t)},initModelViewerLibraries:function(){if(this.sectionSettings.hasModel){const t=this.container.querySelectorAll(this.selectors.productMediaTypeModel);theme.helpers.loadComponent("productModel",()=>{theme.ProductModel.init(t,this.sectionSettings.sectionId)})}},initShopifyXrLaunch:function(){document.addEventListener("shopify_xr_launch",()=>{var t=this.container.querySelector(`${this.selectors.productMediaWrapper}:not(.${this.classes.hidden})`);t&&t.dispatchEvent(new CustomEvent("xrLaunch"))})},triggerMediaChangeEvent:function(t){var e=this.container.querySelectorAll(this.selectors.productMediaWrapper);e.length&&(e.forEach(t=>{t.dispatchEvent(new CustomEvent("mediaHidden"))}),e=this.container.querySelector(this.selectors.productMediaWrapper+`[data-media-id='${t}']`))&&e.dispatchEvent(new CustomEvent("mediaVisible"))},initProductVariants:function(){var t={container:this.container,enableHistoryState:this.sectionSettings.enableHistoryState,singleOptionSelector:this.selectors.singleOptionSelector,masterSelect:this.selectors.masterSelect,product:this.productJSON},t=(this.variants=new theme.Variants(t),this.container.addEventListener("variantChange",t=>{if(this.initProductPage(t),this.setOptionLabel(t),this.sectionSettings.showFilteredImages){var e={name:"jquery",type:"js",src:window.themeVariables.files.vendors.js.jquery};const i=[{name:"slick",type:"css",src:window.themeVariables.files.vendors.css.slick},{name:"slick",type:"js",src:window.themeVariables.files.vendors.js.slick}];theme.helpers.loadAsset(e).then(()=>{theme.helpers.loadAssets(i,()=>{this.filterVariantMedia(t)})})}}),1===this.variants.product.variants.length&&this.container.dispatchEvent(new CustomEvent("variantChange",{detail:{variant:this.variants.product.variants[0]}})),this.container.addEventListener("variantMediaChange",t=>{this.showVariantMedia(t)}),this.container.querySelector(this.selectors.singleOptionSelector));t&&t.dispatchEvent(new Event("change"))},initProductQuantities:function(){this.productQuantity&&(theme.ProductQuantities.setMaxQuantity(this.productQuantity,this.productQuantityInput,this.masterSelect),theme.ProductQuantities.checkQuantity(this.productQuantity,this.productQuantityInput,this.masterSelect),theme.ProductQuantities.setVariantQuantities(this.productQuantity,this.productQuantityInput,this.masterSelect),theme.ProductQuantities.syncQuantityInputs(this.productQuantityInput),this.productQuantity.querySelectorAll(this.selectors.productQuantityButton).forEach(t=>{t.addEventListener("click",()=>{theme.ProductQuantities.checkQuantity(this.productQuantity,this.productQuantityInput,this.masterSelect),theme.ProductQuantities.syncQuantityInputs(this.productQuantityInput)})}),this.productQuantityInput&&this.productQuantityInput.addEventListener("keydown",function(t){t=t.code;"ArrowUp"!==t&&"ArrowDown"!==t&&!t.includes("Digit")||setTimeout(()=>{theme.ProductQuantities.checkQuantity(this.productQuantity,this.productQuantityInput,this.masterSelect),theme.ProductQuantities.syncQuantityInputs(this.productQuantityInput)})}),this.singleOptionSelectors.forEach(t=>{t.addEventListener("change",async()=>{theme.ProductQuantities.setMaxQuantity(this.productQuantity,this.productQuantityInput,this.masterSelect),theme.ProductQuantities.checkQuantity(this.productQuantity,this.productQuantityInput,this.masterSelect),theme.ProductQuantities.syncQuantityInputs(this.productQuantityInput)})}))},initProductPage:function(t){var e=window.themeVariables.settings.moneyFormat;const i=t.detail.variant,s=window.themeVariables.strings;function r(){this.addToCart.classList.remove("disabled"),this.addToCart.removeAttribute("disabled"),this.addToCartText.innerHTML=s.addToCartButton,this.productMeta.classList.remove(this.classes.soldOut),this.productFullDetails&&(this.productFullDetails.href=this.updateUrlParameter(this.productFullDetails.href,"variant",i.id))}function a(){this.addToCart.classList.add("disabled"),this.addToCart.setAttribute("disabled","disabled"),this.addToCartText.innerHTML=s.soldOutButton,this.productMeta.classList.add(this.classes.soldOut)}i?(t=this.masterSelect.querySelector(`option[value="${i.id}"]`),(t=theme.helpers.safelyParseJson(t.dataset.variantSettings)).inventoryQuantity,t.inventoryPolicy,this.productPriceContainer.classList.remove(this.classes.priceContainerUnitAvailable),(i.available?(i.inventory_management,r):a).bind(this)(),this.productPrice.innerHTML=`<span class="money">${theme.Currency.formatMoney(i.price,e)}</span>`,i.compare_at_price>i.price?(this.productPrice.classList.add("on-sale","text-sale"),this.productPrice.setAttribute("aria-label",s.salePrice),this.productPriceCompare.innerHTML=`<span class="money">${theme.Currency.formatMoney(i.compare_at_price,e)}</span>`,this.productPriceCompare.classList.remove(this.classes.hidden)):(this.productPrice.classList.remove("on-sale","text-sale"),this.productPrice.setAttribute("aria-label",s.regularPrice),this.productPriceCompare.innerHTML="",this.productPriceCompare.classList.add(this.classes.hidden)),i.unit_price&&(this.unitPrice.innerHTML=`<span class="money">${theme.Currency.formatMoney(i.unit_price,e)}</span>`,this.unitPriceBaseUnit.innerHTML=this.getBaseUnit(i),this.productPriceContainer.classList.add(this.classes.priceContainerUnitAvailable)),this.sku&&(i.sku?(this.sku.innerHTML=i.sku,this.sku.parentElement.classList.remove(this.classes.hidden)):this.sku.parentElement.classList.add(this.classes.hidden))):a(),document.dispatchEvent(new CustomEvent("theme:addon:custom-currencies:convert-prices"))},setOptionLabel:function(t){const r=t.detail.variant;r&&this.productOptionLabels.forEach(t=>{var e=t.dataset.optionName,i=t.dataset.optionIndex,i=r["option"+i],s=t.querySelector("span:first-of-type");s?s.innerHTML=e+`: <span class="text-sub">${i}</span>`:t.innerHTML=e+`: <span class="text-sub">${i}</span>`})},filterVariantMedia:function(t){const a=t.detail.variant;function i(e){if(e.slider.classList.contains("slick-initialized")&&e.thumbnailsWrapper.classList.contains("slick-initialized")){e.slider.classList.contains("slick-filtered")&&($(e.slider).slick("slickUnfilter").slick("refresh"),$(e.thumbnailsWrapper).slick("slickUnfilter").slick("refresh"));var t=e.sectionSettings.sectionId+"-"+a.featured_media?.id,i=e.container.querySelector(e.selectors.productMediaWrapper+`[data-media-id="${t}"]`),s=e.container.querySelector(e.selectors.productThumbnail+`[data-media-id="${t}"]`);if(i&&s)if(e.triggerMediaChangeEvent(t),a&&a.featured_media&&(e.container.querySelectorAll(e.selectors.productMediaWrapper).forEach(t=>{t.classList.remove(e.classes.featuredMedia)}),i.classList.add(e.classes.featuredMedia)),a.featured_media&&a.featured_media.alt){const r=a.featured_media.alt;$(e.slider).slick("slickFilter",function(t,e){return e.getAttribute("data-thumbnail-alt")===r}).slick("refresh"),$(e.thumbnailsWrapper).slick("slickFilter",function(t,e){return e.getAttribute("data-thumbnail-alt")===r}).slick("refresh"),e.slider.classList.add("slick-filtered")}}}this.sectionSettings.isStackedLayout?a.featured_media&&a.featured_media.alt?(this.container.querySelectorAll("[data-thumbnail-alt]").forEach(t=>{t.style.display="none"}),t=a.featured_media.alt,this.container.querySelectorAll(`[data-thumbnail-alt='${t}']`).forEach(t=>{t.style.display="block"})):this.container.querySelectorAll("[data-thumbnail-alt]").forEach(t=>{t.style.display="block"}):(this.slider=this.container.querySelector(this.selectors.productMediaGroup),this.sliderItems=this.container.querySelector(this.selectors.productMediaFlexWrapper),this.thumbnailsWrapper=this.container.querySelector(this.selectors.productThumbnails),this.slider.classList.contains("slick-initialized")?i(this):new MutationObserver((t,e)=>{this.slider.classList.contains("slick-initialized")&&(i(this),e.disconnect())}).observe(this.slider,{attributes:!0,childList:!1,subtree:!1}),this.thumbnailsWrapper.classList.contains("slick-initialized")?i(this):new MutationObserver((t,e)=>{this.thumbnailsWrapper.classList.contains("slick-initialized")&&(i(this),e.disconnect())}).observe(this.thumbnailsWrapper,{attributes:!0,childList:!1,subtree:!1}))},showVariantMedia:function(e){var e=e.detail.variant,i=this.sectionSettings.sectionId+"-"+e.featured_media.id,s=this.container.querySelector(this.selectors.productMediaWrapper+`[data-media-id="${i}"]`),r=this.container.querySelector(this.selectors.productThumbnail+`[data-media-id="${i}"]`);if(s&&r){this.triggerMediaChangeEvent(i);let t;e&&e.featured_media&&(this.container.querySelectorAll(this.selectors.productMediaWrapper).forEach(t=>{t.classList.remove(this.classes.featuredMedia)}),s.classList.add(this.classes.featuredMedia)),this.sectionSettings.isStackedLayout?this.sectionSettings.isStackedLayout&&(r=s.closest(this.selectors.productMediaFlexWrapper),0<=(t=Array.from(r.parentNode.children).indexOf(r)))&&(991<window.innerWidth?s.scrollIntoView({behavior:"smooth"}):1<r.parentNode.children.length&&$(this.slider).slick("slickGoTo",t)):(i=s.closest(".slick-slide"),t=+i?.dataset.slickIndex,Number.isInteger(t)&&$(this.slider).slick("slickGoTo",t))}},updateUrlParameter:function(t,e,i){var s=new RegExp("([?&])"+e+"=.*?(&|$)","i"),r=-1===t.indexOf("?")?"?":"&";return t.match(s)?t.replace(s,"$1"+e+"="+i+"$2"):t+r+e+"="+i},getBaseUnit:function(t){return 1===t.unit_price_measurement.reference_value?t.unit_price_measurement.reference_unit:t.unit_price_measurement.reference_value+t.unit_price_measurement.reference_unit}}),t}();