!function(){const s={thresholdQuantity:{addon:window.themeVariables.settings.addons.inventoryQuantity}.addon.thresholdQuantity},h={addonWrapper:".dbtfy-inventory-quantity",quantityItem:".dbtfy-inventory-quantity__item",quantityFieldItem:".dbtfy-inventory-quantity__quantity",lessThreshold:".dbtfy-inventory-quantity__threshold--less",moreThreshold:".dbtfy-inventory-quantity__threshold--more",productSection:".product.section",masterSelect:"[data-product-master-select]",optionSelector:"[data-product-option-selector]",atcButton:"[data-product-add-to-cart]"};document.body.classList.add("dbtfy-inventory-quantity-enabled");var t=document.querySelectorAll(h.addonWrapper);function n(u,r,n){async function e(){var t=r.querySelector("[data-product-quantity]"),e=t?.querySelector("input"),d=r.querySelector(h.masterSelect);if(t&&e&&d)try{await theme.ProductQuantities.refreshInventoryData(t,e,d)}catch(t){console.error("Error refreshing inventory:",t)}t=r.querySelector(h.atcButton);if(t&&t.matches(":disabled"))u.setAttribute("hidden","hidden");else{t=r.querySelector(h.masterSelect);if(t){const a=n?n.id:+t.value;if(a){const o=u.querySelectorAll(h.quantityItem);o.length?(Array.from(o).some(t=>+t.dataset.variantId===a)?u.removeAttribute("hidden"):u.setAttribute("hidden","hidden"),o.forEach(t=>{var e,d,r,n,i;+t.dataset.variantId===a?(e=t.querySelector(h.lessThreshold),d=t.querySelector(h.moreThreshold),r=t.querySelector(h.quantityFieldItem),i=theme.cart.items&&theme.cart.items.reduce((t,e)=>e.id===a?t+e.quantity:t,0),n=s.thresholdQuantity,0<(i=+t.dataset.originQuantity-i)?(r&&(r.innerHTML=i),t.removeAttribute("hidden"),d&&(i<=n?(e.removeAttribute("hidden"),d.setAttribute("hidden","hidden")):(e.setAttribute("hidden","hidden"),d.removeAttribute("hidden")))):(t.setAttribute("hidden","hidden"),1===o.length&&u.setAttribute("hidden","hidden"))):t.setAttribute("hidden","hidden")})):u.setAttribute("hidden","hidden")}}}e=u.querySelectorAll(h.quantityItem),(e=Array.from(e).some(t=>!t.hasAttribute("hidden")))?u.removeAttribute("hidden"):u.setAttribute("hidden","hidden")}theme.isCartLoaded?e():document.addEventListener("theme:cart:initially-loaded",t=>{e()})}t.length&&t.forEach(d=>{const r=d.closest(h.productSection);r&&(r.addEventListener("variantChange",t=>{t=t.detail.variant;n(d,r,t)}),n(d,r),document.addEventListener("theme:cart:loaded",(t,e)=>{n(d,r)}))})}();