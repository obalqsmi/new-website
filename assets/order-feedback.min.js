!function(){var e={addon:window.themeVariables.settings.addons.orderFeedback,addonStrings:window.themeVariables.strings.addons.orderFeedback};const s={requiredToCheckout:e.addon.requiredToCheckout,otherText:e.addonStrings.otherText},u={section:".dbtfy-order-feedback",select:".dbtfy-order-feedback__select",inputOther:".dbtfy-order-feedback__input-other",error:".dbtfy-order-feedback__error",errorOther:".dbtfy-order-feedback__error-other",formOther:".dbtfy-order-feedback__form-other"};function t(){s.requiredToCheckout&&theme.requiredToCheckoutAddons.init("order-feedback");const n=document.querySelectorAll(u.section);function c(e){var t=e.closest(u.section).querySelector(u.formOther);s.otherText&&e.value===s.otherText?t&&t.removeAttribute("hidden"):t&&t.setAttribute("hidden","hidden")}function i(e,t){t=e.closest(u.section).querySelector(t);0===e.value.length?(e.classList.add("error"),t.removeAttribute("hidden")):e.classList.contains("error")&&(e.classList.remove("error"),t.setAttribute("hidden","hidden"))}n.forEach(e=>{const d=e.querySelector(u.select),r=e.querySelector(u.inputOther);if(d){const a=d.getAttribute("name"),t=r?.getAttribute("name");d.addEventListener("change",()=>{var e=d.value;const o=d.options[d.selectedIndex];c(d),n.forEach(e=>{e=e.querySelector(u.select);e&&e!==d&&(e.selectedIndex=d.selectedIndex,c(e),s.requiredToCheckout)&&i(e,u.error)}),s.requiredToCheckout&&(i(d,u.error),""===d.value||d.value===s.otherText&&r&&""===r.value?theme.requiredToCheckoutAddons.update({name:"order-feedback",errors:!0,isChanged:!0}):theme.requiredToCheckoutAddons.update({name:"order-feedback",errors:!1,isChanged:!0})),localStorage.setItem("orderFeedback",e);var t={};t[a]=theme.helpers.attributeToString(e),fetch("/cart/update.js",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(t)}).then(e=>e.json()).then(e=>{var t,r;o.hasAttribute("data-is-other-option")||((t=d.querySelector("[data-is-other-option]"))&&((r={})[t.dataset.name]="",fetch("/cart/update.js",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(r)}).catch((e,t)=>{theme.ShopifyAPI.onError(e,t)})),n.forEach(e=>{e=e.querySelector(u.inputOther);e&&(e.value="")}))}).catch((e,t)=>{theme.ShopifyAPI.onError(e,t)})}),r&&r.addEventListener("input",()=>{var e;n.forEach(e=>{e=e.querySelector(u.inputOther);e&&(e.value=r.value),i(e,u.errorOther)}),0!==r.value.length&&t?((e={})[t]=theme.helpers.attributeToString(r.value),fetch("/cart/update.js",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e)}).catch((e,t)=>{theme.ShopifyAPI.onError(e,t)}),s.requiredToCheckout&&theme.requiredToCheckoutAddons.update({name:"order-feedback",errors:!1,isChanged:!0})):s.requiredToCheckout&&theme.requiredToCheckoutAddons.update({name:"order-feedback",errors:!0,isChanged:!0})}),localStorage.orderFeedback?(d.value=localStorage.getItem("orderFeedback"),c(d),s.requiredToCheckout&&(d.value===s.otherText&&r&&""===r.value?theme.requiredToCheckoutAddons.update({name:"order-feedback",errors:!0}):theme.requiredToCheckoutAddons.update({name:"order-feedback",errors:!1}))):(""===localStorage.orderFeedback&&(d.value=""),s.requiredToCheckout&&theme.requiredToCheckoutAddons.update({name:"order-feedback",errors:!0}));e={};e[a]=theme.helpers.attributeToString(d.value),fetch("/cart/update.js",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e)}).catch((e,t)=>{theme.ShopifyAPI.onError(e,t)})}}),document.querySelectorAll("[name='checkout'], [name='goto_pp'], [name='goto_gc']").forEach(function(c){c.hasAttribute("data-has-feedback-click")||(c.addEventListener("click",t=>{var r=c.closest("form"),o=r?.querySelector(u.section);if(o&&s.requiredToCheckout){var r=r.querySelector(u.select),d=o.querySelector(u.inputOther);let e=!0;if(0===r.value.length&&(i(r,u.error),e=!1),s.otherText&&r.value===s.otherText&&d&&0===d.value.length&&(i(d,u.errorOther),e=!1),e)theme.requiredToCheckoutAddons.update({name:"order-feedback",errors:!1,isCheckoutButtonEventHandled:!0,button:{element:c,event:t}});else{theme.requiredToCheckoutAddons.update({name:"order-feedback",errors:!0,isCheckoutButtonEventHandled:!0,button:{element:c,event:t}});let e;"drawer"===window.themeVariables.settings.cartType?e="#CartDrawer":"modal"===window.themeVariables.settings.cartType&&(e="#CartModal");var r=c.closest(e),d=document.body.classList.contains("template-cart"),t=r?.querySelector(".drawer__header"),a=r?.querySelector(".drawer__inner"),n=r?.querySelector("form"),o=o.offsetTop||0,t=t?.innerHeight||0,n=n?.offsetTop||0;r&&(r.classList.contains("js-drawer-open")||r.classList.contains("js-modal-open"))?a.scrollTo({top:o-t-n,behavior:"smooth"}):d&&(r=document.querySelector(".header"),a=document.querySelector(".cart__form")?.querySelector(u.section),o=document.body.classList.contains("sticky-header"),t=a?.offsetTop||0,n=o?r.innerHeight:0,window.scrollTo({top:t-n-15,behavior:"smooth"}))}}}),c.setAttribute("data-has-feedback-click","true"))})}document.body.classList.add("dbtfy-order-feedback-enabled"),s.requiredToCheckout?theme.helpers.loadComponent("requiredToCheckout",()=>{t()}):t(),document.addEventListener("theme:cart:loaded",e=>{s.requiredToCheckout?theme.helpers.loadComponent("requiredToCheckout",()=>{t()}):t()})}();